#!/usr/bin/env bash
# randompass â€” generate an unambiguous alphanumeric password of length N

set -euo pipefail

usage() {
  echo "Usage: $0 <length>" >&2
  exit 1
}

if [[ $# -lt 1 ]]; then
  usage
fi

n="$1"
if ! [[ "$n" =~ ^[0-9]+$ ]] || [[ "$n" -le 0 ]]; then
  echo "Error: length must be a positive integer" >&2
  exit 2
fi

# Keep tr ranges predictable
export LC_ALL=C

# Allowed set: A-Z a-z 0-9, minus 0,O,1,l,I
# Explicitly list the safe alphabet to avoid locale surprises
alphabet='ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz23456789'  # no 0/O/1/l/I

# Generate by filtering urandom to the explicit alphabet
tr -dc "$alphabet" </dev/urandom | head -c "$n"
echo
